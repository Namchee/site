[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.9.1","content-config-digest","286fb2b71c491e09","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://www.namchee.dev\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"prefetch\":true,\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[\"books.google.com\",\"assets.literal.club\",\"res.cloudinary.com\"],\"remotePatterns\":[],\"experimentalDefaultStyles\":true},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\",\"mermaid\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{\"light\":\"one-light\",\"dark\":\"tokyo-night\"},\"wrap\":false,\"transformers\":[{\"name\":\"@shikijs/transformers:meta-highlight\"},{}]},\"remarkPlugins\":[null,null,null,null],\"rehypePlugins\":[null,null],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"responsiveImages\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"csp\":false},\"legacy\":{\"collections\":false}}","posts",["Map",11,12,26,27,38,39,49,50,59,60,69,70,80,81,91,92],"_test-page",{"id":11,"data":13,"body":23,"filePath":24,"digest":25,"deferredRender":22},{"title":14,"subtitle":15,"tags":16,"publishedAt":21,"isDraft":22},"Post Test Page","This is a dummy blogpost page to test how the blogpost would look",[17,18,19,20],"growth","testing","javascript","typescript",["Date","2023-12-15T00:00:00.000Z"],true,"import Tweet from 'astro-tweet';\n\nimport DescriptionList from '@/components/astro/modules/posts/html/DescriptionList.astro';\nimport DescriptionTerm from '@/components/astro/modules/posts/html/DescriptionTerm.astro';\nimport DescriptionItem from '@/components/astro/modules/posts/html/DescriptionItem.astro';\n\nLorem ipsum dolor sit amet consectetur. Vitae amet tortor bibendum sit cursus et nisi non. Sagittis aliquet augue purus dignissim. Sodales pellentesque felis eleifend tristique molestie. **Accumsan amet erat mauris** consequat urna fames felis et sed.\n\nDiam nisl sit volutpat est pellentesque aliquet porttitor egestas commodo. Purus vitae egestas nunc turpis urna placerat proin dui mi. Iaculis sed in dui nisl. Hendrerit odio lectus enim vitae euismod enim. Urna lorem scelerisque nunc leo nunc odio mauris sed sed. Pharetra cras aenean tincidunt morbi purus molestie. Proin lobortis senectus pretium vel. Proin lobortis senectus pretium vel.\n\n![Image by Dude from Unsplash](https://res.cloudinary.com/namchee/image/upload/v1718288376/posts/test-page/banner.jpg)\n\n## Some Random Title\n\nDiam nisl sit volutpat est pellentesque aliquet porttitor egestas commodo. Purus vitae egestas nunc turpis urna placerat proin dui mi. Iaculis sed in dui nisl. Hendrerit odio lectus enim vitae euismod enim. Urna lorem scelerisque nunc leo nunc odio mauris sed sed. Pharetra cras aenean tincidunt morbi purus molestie.\n\nLorem ipsum dolor sit amet consectetur. Vitae amet tortor bibendum sit cursus et nisi non. Sagittis aliquet augue purus dignissim. Sodales pellentesque felis eleifend tristique molestie. Accumsan amet erat mauris consequat urna fames felis et sed.\n\n```ts title=This is a sample code snippet, copyable\nfunction testAdd() {\n  const a = 1; // idk man, I think this is a comment? But it's harmless at least!\n  const b = 1;\n  const c = 3; // [!code highlight]\n\n  const d = 4;\n\n  const f = 10;\n  const t1 = 122;\n  expect(add(1, 2)).toBe(2); // this should be true btw\n}\n```\n\n### A randomly-placed subheading\n\nLorem ipsum dolor sit amet consectetur. Vitae amet tortor bibendum sit cursus et nisi non. Sagittis aliquet augue purus dignissim. Sodales [pellentesque](https://www.google.com) felis eleifend tristique molestie. Accumsan amet erat mauris consequat urna fames felis et sed.\n\n```ts\nfunction testAdd() {\n  const a = 1;\n  const b = 1;\n  const c = 3;\n\n  const d = 4;\n\n  const f = 10;\n  const t1 = 122;\n  expect(add(1, 2)).toBe(2); // this should be true btw\n}\n```\n\n## Plant bullets in their lines\n\nDiam nisl sit volutpat est pellentesque aliquet porttitor egestas commodo. Purus vitae egestas nunc turpis urna placerat proin dui mi. Iaculis sed in dui nisl. Hendrerit odio lectus enim vitae euismod enim. Urna lorem scelerisque nunc leo nunc odio mauris sed sed. Pharetra cras aenean tincidunt morbi purus molestie.\n\n![A portrait image, for no reason](https://res.cloudinary.com/namchee/image/upload/v1718289415/posts/test-page/portrait.jpg)\n\nDiam nisl sit volutpat est pellentesque aliquet porttitor egestas commodo. Purus vitae egestas nunc turpis urna placerat proin dui mi. Iaculis sed in dui nisl. Hendrerit odio lectus enim vitae euismod enim. Urna lorem scelerisque nunc leo nunc odio mauris sed sed. Pharetra cras aenean tincidunt morbi purus molestie. Proin lobortis senectus pretium vel. Proin lobortis senectus pretium vel.\n\n\u003CTweet id=\"1068615953989087232\" />\n\n## Testing List\n\n- This is a list\n- This is another item of the list\n- Lastly, this is another item!\n\n## Testing&nbsp;`\u003Cdd>`\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    Sample Term\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    In a world that's constantly changing, staying true to your values and goals can feel like navigating through a storm. Yet, it's in those moments of uncertainty that our character is truly tested and shaped.\n\n    As we move forward, let's remember that progress often lies in persistence and that even the smallest efforts contribute to something greater. Keep striving, keep growing, and always trust in your ability to adapt and succeed.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Another Term\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    Since I found my past experiments to be insightful, I will continue my code playground and share ideas or experiments I've conducted as either code snippets or posts.\n    Hopefully, I can test out my ideas and sharpen them through public feedback. Don't be shy to drop feedback!\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\n## Final Thoughts\n\nLife is a journey filled with twists, turns, and surprises, and it's often the moments we least expect that leave the greatest impact.\nWhether it's the lessons learned from challenges or the joy found in simple pleasures, every experience adds depth to our stories.\n\nAs we close this chapter, let's carry forward the resilience and insights we've gained, knowing that each step taken is a step closer to becoming the best version of ourselves.","posts/_test-page.mdx","2ee06329b8203190","anchoring-to-text-fragment",{"id":26,"data":28,"body":35,"filePath":36,"digest":37,"deferredRender":22},{"title":29,"subtitle":30,"tags":31,"publishedAt":33,"isDraft":34},"Anchoring To Text Fragment","Jumping straight to point of interest without element wrapping",[32,19],"web",["Date","2025-04-28T00:00:00.000Z"],false,"import Tweet from 'astro-tweet';\nimport { Image } from 'astro:assets';\n\nimport TextLink from '@/components/astro/ui/TextLink.astro';\nimport TextFragmentApi from '@/components/vue/posts/TextFragmentApi.vue';\n\nI'm pretty sure most of you are already familiar with the concept of **in-page links**&mdash;URLs that contain a hashbang and make the page jump to a specific marked element.\nStill not familiar? Well, you can try it out by clicking links inside the table of contents on the left side of this page.\n\n\u003Cfigure class=\":uno: my-4 md:-ml-4 md:w-[calc(100%+32px)] overflow-x-visible\">\n  \u003CImage\n    src=\"https://res.cloudinary.com/namchee/image/upload/f_auto,q_auto/v1/posts/anchoring-to-text-fragment/toc-showcase\"\n    alt=\"What clicking the Table of Contents would do\"\n    title=\"What clicking the Table of Contents would do\"\n    width={670}\n    height={343}\n    class=\":uno: rounded-md\"\n  />\n\n  \u003Cfigcaption class=\":uno: text-xs mt-2 text-center italic\">\n    What clicking links in the Table of Contents would do\n  \u003C/figcaption>\n\u003C/figure>\n\nThe main use case of in-page links is to allow users to quickly navigate lengthy pages to a section of interest which in turn will increase UX and SEO-wise,\nincrease discoverability and engagement that might increase user conversion rates.\n\nImplementing in-page links is pretty simple, all you need to do is to mark the section of interest with `id` and append a `#\u003Cid>` to your links.\n\n```html title=URL Fragment 101, noLang\n\u003C!-- say, you want to jump directly to this section on navigate -->\n\u003Cdiv id=\"section-of-interest\">\n\tYou just got coconut mall'ed\n\u003C/div>\n\n\u003C!-- on the same page, you can jump to this section just by hash + id -->\n\u003Ca href=\"#section-of-interest\">Wanna have some fun?\u003C/a>\n\n\u003C!-- on different page, append the path with hash + id -->\n\u003Ca href=\"/cool-page#section-of-interest\">Wanna have some fun?\u003C/a>\n\n\u003C!-- when sharing to external source, again, just append hash + id -->\nhttps://www.your-site.com/cool-page#section-of-interest\n```\n\n## Jumping To Text?\n\nBut let's say one day you want to create a link that allows users to jump a specific text instead of marked sections.\nWell easy, just mark the text in a `\u003Cspan>` and give it a unique `id` to them! Unfortunately, it doesn't scale for the following reasons:\n\n- The solution only works if you have full control over the content. It doesn't work for third-party generated content, whether from users or these days, LLMs\n- More elements means adding unnecessary complexity. Need to add words to the marked text? What if the `id` is invalid? Well, you have to modify the code again!\n\nSince using standard element fragment clearly doesn't scale well, we can try using JavaScript to solve the problem which should look similar to the following\n\n```js title=scroll-to-text.js\nconst targetText = `coconut mall'ed`;\n\n// let's say the text is always a descendant of this element\nconst container = document.querySelector('.content');\n\n// Create a TreeWalker, which is more efficient than iterating nodes recursively\nconst walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT);\n\nlet node = null;\n\nwhile (walker.nextNode()) {\n\tif (walker.currentNode.nodeValue.includes(targetText)) {\n\t\tnode = walker.currentNode;\n\t\tbreak;\n\t}\n}\n\nif (node && node.parentElement) {\n\t// can't scroll directly to text, so we scroll to the nearest ancestor\n\t// which is the parent of course\n\tnode.parentElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n}\n```\n\nUnfortunately, this means another reliance on JavaScript. What if your user disables JavaScript? What if you want to reduce JavaScript footprint in your site? Or maybe\n[you've had enough of JavaScript](https://www.globalnerdy.com/wp-content/uploads/2020/11/javascript-is-olive-oil-for-developers.jpg)?\n\nTurns out, TC39 has addressed this by introducing [URL Fragment Text Directives](https://wicg.github.io/scroll-to-text-fragment/), [first introduced to the public\nin 2020](https://www.theverge.com/2020/6/4/21280115/google-search-engine-yellow-highlight-featured-snippet-anchor-text) and finally hit stable status in 2023.\n\n## Dissecting the API\n\nSimilar to element fragment, you can insert text fragments into a URL using a hashbang with the following syntax (psst, try to interact with your pointers!):\n\n\u003CTextFragmentApi client:only />\n\nWhile it does look similar to your standard element fragment, there are few key differences besides stricter format:\n\n- All inputs within this directive must be [percent-encoded](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent) with\n\tsome additional cases explained in the below section.\n- Each part of the syntax must reside inside one [block-level element](https://developer.mozilla.org/en-US/docs/Glossary/Block-level_content),\n\thowever the whole match may span across multiple blocks.\n- It's possible to define multiple text fragments by separating them with `&` just like what you usually do with query strings. [Example](#:~:text=separating&text=query)\n- Instead of styling the fragment with `:target` pseudo-class, the text fragments are styled with `::target-text` pseudo-element.\n\tBy default, the browser will style text fragments with the same default style as `\u003Cmark>`.\n\nWhen browsers received a navigation to a URL that contains text fragment(s), it will try to find texts that matches the directive **even if they're visually hidden**.\n\nIf a text matching the fragment is found, the browser will scroll to and highlight the first matching fragment. If no match is found, the browser will do nothing.\n\n### Building Text Fragment\n\nAfter a short introduction to the API and what its trying to solve, now you're ready to build your first text fragment.\n\nThings will go pretty simple if you want to build the fragment programmatically while you have full control of the content. All you have to do\nis encode the fragment with `encodeURIComponent` function, which should be available as a global JavaScript API.\n\nHowever as mentioned above, you also need to handle special cases for `-`, `&`, and `,` characters, as they also need to be percent-encoded to\navoid confusion with the text directive syntax [per the spec](https://wicg.github.io/scroll-to-text-fragment/#syntax).\n\n```js title=Building Text Fragment Programmatically, copy\nfunction encodeTextFragment(fragment) {\n\treturn encodeURIComponent(fragment)\n\t\t.replace(\n\t\t\t/[-&,]/g,\n\t\t\t(c) => '%' + c.charCodeAt(0).toString(16).toUpperCase()\n\t\t);\n}\n\n// Sample usage\nconst textPrefix = encodeTextFragment('you just got');\nconst textStart = encodeTextFragment(`coconut`);\nconst textEnd = encodeTextFragment(`mall-ed`);\nconst textSuffix = encodeTextFragment('share this to your friends & family!');\n\nconst baseUrl = '/cool-page';\nconst url = `${baseUrl}#:~:text=${textPrefix}-,${textStart},${textEnd},-${textSuffix}`;\n```\n\nIf you don't have control over the content or simply want an easy way to generate a text fragment without touching the markup, you can use web extensions for\n[Chromium-based browsers](https://chromewebstore.google.com/detail/link-to-text-fragment/pbcodcjpfjdpcineamnnmbkkmkdpajjg),\n[Edge](https://microsoftedge.microsoft.com/addons/detail/link-to-text-fragment/pmdldpbcbobaamgkpkghjigngamlolag),\n[Firefox](https://addons.mozilla.org/firefox/addon/link-to-text-fragment/), and\n[Safari](https://apps.apple.com/app/link-to-text-fragment/id1532224396) to generate one for you.\n\n\n### Interaction With Element Fragment\n\nSince text fragment occupies the same hashbang spot as element fragment, you might be wondering if it's possible to combine them both. Actually, you can!\nYou only need to append the text fragment directive after element fragment. For example:\n\n\u003CTextLink class=\"font-mono text-heading text-center my-4\" href=\"#jumping-to-text:~:text=since,scale%20well\">#jumping-to-text:~:text=since,scale%20well\u003C/TextLink>\n\nIn this case, the element fragment acts as fallback for text fragment directive if the browser cannot find matching text with the text fragment directive\nas demonstrated by [this link](#interaction-with-element-fragment:~:text=wumbologic), where I searched the text `wumbologic` while falling back to this section.\n\nHowever if the browser is able to find text(s) that satisfies the text fragment directive, the browser will ignore the element fragment\nas demonstrated by [this link](#building-text-fragment:~:text=text(s)), where I searched the text `text(s)` while falling back to the previous section.\n\n## Is It A 'Navigation'?\n\nAfter reading the features and API specification above, you might think this API solves a use case you need for your app.\nYou have played around with it in an isolated environment and finds out that it works as you expected.\n\nYou then ported the functionality to your app that uses a client-side navigation with [History API](https://developer.mozilla.org/en-US/docs/Web/API/History_API)\nwhich should look similar to the following:\n\n```js title=Text fragment directive with History API. Surely nothing could go wrong!\nconst targetText = `coconut mall'ed`;\n\nif (window.history) {\n\tconst fragment = encodeURIComponent(targetText);\n\tconst url = `/cool-page#:~:text=${fragment}`;\n\n\twindow.history.pushState(null, '', url);\n}\n```\n\nUnfortunately, you'll find out that the text fragment doesn't work and the page just navigates normally.\nThis is an expected behavior, as the text fragment directive only triggers on **user-initiated navigations**.\n\nSimply put, only navigations triggered via browser's back-forward buttons and through HTML elements that supports navigation such as\n`\u003Ca>` and `\u003Cform>` that will trigger browser's behavior of text fragment directive.\n\nFor those of you that programmatically navigates using JavaScript, your only option to replicate the text fragment directive behavior is using JavaScript.\n\n> Please consult to the [Navigation API Appendix](https://github.com/WICG/navigation-api#appendix-types-of-navigations) for more information about which navigation counts as user-initiated or not.\n\n## Extracting The Fragment\n\nSuppose that you want to retrieve the text directive programmatically, either for analytical purposes or to\nalter specific scrolling behavior, such as disabling scroll-to-bottom when a text fragment directive is present.\n\nWell, since the directives are stored in hash bangs, we should be able to read the `hash` property from `URL` and parse it from there no?\n\n```js title=Extracting text fragment directive that definitely don't work\n// suppose that the the current URL is `/cool-page#:~:text=xxx`\nconst hash = window.location.hash;\nconst textFragment = hash.match(/:~:text=(.+):/);\n\nif (textFragment) {\n\tconst fragments = textFragment[1]\n\t\t.split('&') // account for possible multi-fragment\n\t\t.map((fragment) => decodeURIComponent(fragment));\n\n\tconsole.log(fragments); // it's empty?\n}\n```\n\nUnfortunately, you can't retrieve text fragments from `hash` as per the WICG specification,\n[text fragment directives should be hidden and won't be exposed to user agents](https://wicg.github.io/scroll-to-text-fragment/#:~:text=to%20prevent%20impacting%20page%20operation).\n\nThis behavior is made to maintain compatibility with hash-based navigations used in old client-side navigation library (old React Router anyone?).\nWhile there is [acknowledged need of it](https://github.com/WICG/scroll-to-text-fragment/issues/128), it's still not progressing anywhere.\n\n> At the time of writing, there's an [acknowledged bug](https://issues.chromium.org/issues/40136467) in Chromium-based browsers that allows you to retrieve text fragment directive by exploiting the **Performance API**,\n> specifically by parsing `PerformanceNavigationTiming` interface.\n>\n> ```js title=Extracting text fragment directive that works (on Chromium browsers),copy\n> const navigationEvent = performance\n> \t.getEntriesByType('navigation')[0];\n>\n> // Should be `PerformanceNavigationTiming`\n> const hash = new URL(navigationEvent.name).hash;\n> // Match until the next possible directive\n> const textFragment = hash.match(/:~:text=(.+):/);\n>\n> if (textFragment) {\n>\tconst fragments = textFragment[1]\n>\t\t.split('&') // account for possible multi-fragment\n>\t\t.map((fragment) => decodeURIComponent(fragment));\n>\n>\tconsole.log(fragments); // it's NOT empty 🎉\n> }\n> ```\n>\n> But as a good developer, you shouldn't rely on a *bug* even if you're only targeting Chromium-based browsers.\n\n## Security & Privacy\n\nText fragment directive can be created by anyone who has access to your website so it's a reasonable concern to consider its security and privacy implications.\n\nWhile in the [previous section](#dissecting-the-api) I wrote that text fragment directive works on user-activated navigations, there is one more requirement\nthat the directive should fulfill: cross-origin requests should happen in `noopener` context which ensures the target page to be isolated.\n\nThis context requirements ensures that the directive won't be invoked from a `\u003Ciframe>` navigation and texts won't be searched inside an `\u003Ciframe>`.\nWhile text fragment directive does look secure from a glance, the directive does open [a new attack vector related with scrolling](https://docs.google.com/document/d/1YHcl1-vE_ZnZ0kL2almeikAj2gkwCq8_5xwIae7PVik/edit?tab=t.0).\n\nThis possible attack vector has raised privacy concerns, leading Brave to [temporarily disable this directive](https://github.com/brave/brave-browser/issues/8342) which has been re-enabled on\n[version 1.78](https://github.com/brave/brave-browser/issues/44265) which should be released by the time this post goes public.\n\nIf you're in full-control of your site, you can tell the browser to not process **any** fragments site-wide by setting\nthe `Document-Policy` header with the following value.\n\n```yaml title=Enforce the page to ignore fragments including element fragment, noLang\n# ⚠️ Warning! This disables element fragment too!\nDocument-Policy: force-load-at-top\n```\n\nFor enterprise environments that uses Chrome, network administrators may also disable text fragments by setting the `ScrollToTextFragmentPolicy` policy.\n\n## Final Thoughts\n\n[First implemented on Google Search in 2020](https://www.searchenginejournal.com/google-updates-featured-snippets/371235), the text fragment directive has provided a better way to\nshare higher quality references via URLs by allowing direct links to arbitrary text anywhere on a web page, compared to the element fragment.\n\nAt the same time, text fragments let users share references in a less restrictive way, as they are not as\ndependent on how much control the link creator has over the content&apos;s structure, giving more freedom to the users.\n\nWith these advantages in mind and the ease of generating them using browser plugins, I hope that *you* will consider adopting text fragment directives as a\nhigher-quality alternative for providing references and citations. Happy (deep)linking!","posts/anchoring-to-text-fragment.mdx","0313aa3b31b6c77e","embracing-code-coverage-effectively",{"id":38,"data":40,"body":46,"filePath":47,"digest":48,"deferredRender":22},{"title":41,"subtitle":42,"tags":43,"publishedAt":45,"isDraft":34},"Embracing Code Coverage Effectively","High coverage ≠ flawless code",[44,18],"engineering",["Date","2024-08-31T00:00:00.000Z"],"import Tweet from 'astro-tweet';\n\nimport DescriptionList from '@/components/astro/modules/posts/html/DescriptionList.astro';\nimport DescriptionTerm from '@/components/astro/modules/posts/html/DescriptionTerm.astro';\nimport DescriptionItem from '@/components/astro/modules/posts/html/DescriptionItem.astro';\n\nWriting high-quality code means writing high-quality tests. A common metric used to measure test quality is code coverage.\nFor many projects, code coverage is used as one of the thresholds for acceptable code.\n\nSadly, code coverage is frequently misused in two ways:\n\n- Using code coverage with excessive thresholds\n- Using code coverage as **the** metric of test quality\n\nDue to its common misuse, code coverage has spawned differing views on its effectiveness.\nWhile the effectiveness of code coverage may vary across teams, there&apos;s one statement\nthat I would like to focus on: code coverage is **a** metric, not **the** metric for test quality.\n\n## Primers of Code Coverage\n\nBy its definition, code coverage is a percentage of source code that has been executed during a particular test suite.\nThere are various types of code coverage but the commonly used ones are *functions*, *statements*, *branches*, and *lines*.\n\nIn theory, higher code coverage means lower chance for a software to have undetected bugs as they have more of its source code\nexecuted during software testing compared to a software that has lower code coverage.\n\nCode coverage is calculated by an additional static analysis tool called **coverage reporter** that instruments and collect metrics\nof the tested code. These metrics will then be divided by the total metrics of the code, resulting in a percentage of coverage.\n\nTo illustrate code coverage better, suppose that we have a collection of mathematical helper functions that we store in `math.ts`:\n\n```ts title=math.ts, copyable\n/**\n * Perform an addition between 2 numbers.\n *\n * @args {number} a - First number\n * @args {number} b - Second number\n *\n * @returns {number} Sum of `a` and `b`\n */\nexport function add(a: number, b: number): number {\n    return a + b;\n}\n\n/**\n * Perform a division between 2 numbers.\n *\n * @args {number} a - First number\n * @args {number} b - Second number\n *\n * @returns {number} `a` divided by `b`\n */\nexport function divide(a: number, b: number): number {\n    return a / b;\n}\n\n/**\n * Perform a modulo operation between 2 numbers.\n *\n * @args {number} a - First number\n * @args {number} b - Second number\n *\n * @returns {number} Remainder of `a` divided by `b`\n */\nexport function modulo(a: number, b: number): number {\n    return a % b;\n}\n\n```\n\n`math.ts` is tested by the following test file:\n\n```ts title=math.spec.ts\nimport { describe, it, expect } from 'vitest';\n\nimport { add, divide } from './math';\n\ndescribe('math.ts', () => {\n  it('should add two numbers', () => {\n    expect(add(1, 2)).toBe(3);\n  });\n\n  it('should divide two numbers', () => {\n    expect(divide(10, 2)).toBe(5);\n  });\n});\n```\n\nAfter execution, the test runner reports the following code coverage:\n\n```bash noLang\n----------|---------|----------|---------|---------|-------------------\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s\n----------|---------|----------|---------|---------|-------------------\nAll files |   77.77 |      100 |   66.66 |   77.77 |\n math.ts  |   77.77 |      100 |   66.66 |   77.77 | 34-35\n----------|---------|----------|---------|---------|-------------------\n```\n\nThe code coverage report shows that the test covers all possible branches, as the source code\ndoesn't have any alternative path of execution through a branching statement such as `if` or `switch`.\n\nHowever, the coverage report also shows that the test hasn't fully explored all statements,\nfunctions, and lines in our code as the `modulo` function is not executed in any test scenario.\n\n## Misusing Code Coverage\n\nFrom my observation, there are two reasons why code coverage is a popular metric for tests:\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    Easy to Measure\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    Depending on the maturity of the test ecosystem, measuring code coverage\n    can be as simple as enabling the coverage reporter through a command line flag or a\n    configuration key in a testing framework\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Quantitative\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    Since code coverage is a quantitative metric, code coverage can be easily compared to one another.\n    We can always say that a code with higher coverage covers more scenario and states than a code with low coverage.\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\nAt a glance, code coverage seems to be the all-in-one metric for measuring test quality, as it can show parts of the code\nthat have been executed by the test suite. Most of the time, engineering teams apply a threshold of coverage to reach for\na code to be considered as acceptable.\n\nUnfortunately, the obsession with quantitative data often led to an exceedingly high code coverage threshold to be considered\nacceptable. Contrary to its purposes, setting the threshold too high is **counterproductive** for the following reasons:\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    Limited Engineering Time\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    While increasing coverage from 0% to ~60% is relatively simple, the same cannot be said for increasing coverage from 80% to ~90%.\n    Rather than getting blocked by the coverage requirements, engineers should spend their time prioritizing more important tasks,\n    such as developing critical features.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Promoting Bad Standards\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    Nifty engineers have devised a workaround for the combination of unrealistic thresholds and tight deadlines: **assertion-free tests**.\n    Consider the following function:\n\n    ```ts title=divide.ts\n    /**\n     * Perform a division between 2 numbers.\n     *\n     * @args {number} a - First number\n     * @args {number} b - Second number\n     *\n     * @returns {number} `a` divided by `b`\n     */\n    export function divide(a, b) {\n\t    return a - b; // oops\n    }\n    ```\n\n    An assertion-free test will &apos;test&apos; the code above with the following test suite:\n\n    ```ts title=divide.spec.ts\n    import { describe, it, expect } from 'vitest';\n\n    import { add, subtract, divide } from './math';\n\n    describe('math.ts', () => {\n      it('should divide two numbers', () => {\n        const result = divide(10, 2); // surprise, it's not 5!\n      });\n    });\n    ```\n\n    Executing the 'test' above will guarantee you a 100% coverage from the coverage reporter, even though the\n    result doesn&apos;t match with the intention of the function.\n\n    In this case code coverage only promotes a sense of false security through false positive results,\n    which is a good example of [Goodhart&apos;s Law](https://en.wikipedia.org/wiki/Goodhart%27s_law):\n\n    > Any observed statistical regularity will tend to collapse once pressure is placed upon it for control purposes\n\n    Assertion-free tests aren&apos;t 100% useless as they are still able to catch common bugs such as bad pointers.\n\n    However, writing a test without assertion is a waste of time as it defeats the whole purpose of testing:\n    ensuring the tested code is **working as expected**.\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\n## What Code Coverage Can&apos;t Tell You\n\nSome may argue that the problems stated above are primarily a management problem or bad test cases problem and\ndoesn&apos;t correlate with why code coverage isn&apos;t the metric for test quality.\n\nHowever, fixing those bad tests and changing the mindset of the management doesn&apos;t cover the inherent weakness of\ncode coverage: *it doesn&apos;t guarantee that all possible program states are explored*.\n\nLet&apos;s revisit the `divide` function from the example above:\n\n```ts title=divide.ts\n/**\n * Perform a division between 2 numbers.\n *\n * @args {number} a - First number\n * @args {number} b - Second number\n *\n * @returns {number} `a` divided by `b`\n */\nexport function divide(a, b) {\n\treturn a - b; // oops\n}\n```\n\nwhich is tested by the following test suite:\n\n```ts title=divide.spec.ts\nimport { expect, it } from 'vitest';\n\nimport { divide } from '.';\n\nit(\"should pass\", () => {\n  const a = 2;\n  const b = 1;\n\n  expect(divide(a, b)).toBe(2);\n});\n```\n\nAfter executing the above test suite, the coverage report will output the following coverage report:\n\n```bash noLang\n----------|---------|----------|---------|---------|-------------------\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s\n----------|---------|----------|---------|---------|-------------------\nAll files |     100 |      100 |     100 |     100 |\n math.ts  |     100 |      100 |     100 |     100 |\n----------|---------|----------|---------|---------|-------------------\n```\n\nwhich basically says that all of our code has been covered by our test suite, therefore is fully tested *in theory*.\nBut what if the `divide` function is called with the following arguments?\n\n```ts title=Nah it's fine as I have 100% coverage. Right?\nconst c = divide(1, 0);\n\n// Aw, snap! 🙄\n```\n\nThe function will just throw a `RangeError` exception to the user. While the problem itself lies in the lack of test cases,\ncode coverage cannot tell you that you *lack one*.\n\nThis is not surprising as coverage reporter is inherently just a *static* analysis tool, which only provides an analysis based\non provided data in test suites. It does not provide an analysis on how the code is executed in *reality*.\n\nThe mismatch between how the code behaves according to the code coverage and how it behaves in reality is better illustrated\nin the following Tweet:\n\n\u003CTweet id=\"1068615953989087232\" />\n\n## What Code Coverage CAN Tell You\n\nJudging from the misuse and weakness I&apos;ve presented in the previous sections, does it mean that code coverage has made\nus waste a lot of engineering time to chase for useless numbers?\n\nFortunately not! Let&apos;s revisit the coverage report from [Primers of Code Coverage](#primers-of-code-coverage) section:\n\n```bash noLang\n----------|---------|----------|---------|---------|-------------------\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s\n----------|---------|----------|---------|---------|-------------------\nAll files |   77.77 |      100 |   66.66 |   77.77 |\n math.ts  |   77.77 |      100 |   66.66 |   77.77 | 34-35\n----------|---------|----------|---------|---------|-------------------\n```\n\nTake the function coverage as an example. Based on the weaknesses of code coverage, we can&apos;t confidently say that\n66.66% of the functions has been fully tested yet as code coverage doesn&apos;t guarantee that all program states has been explored.\n\nHowever if we focused on what&apos;s *missing* from the test result and combine them with how code coverage is calculated, we can\nconfidently say that 33.34% of the functions has not been tested at all as none of our test suite has executed those functions.\n\nThis observation has revealed what code coverage is good at: finding the untested. Instead of treating code coverage as **the** metric\nof test quality, engineering teams should treat it as **a** metric to find untested part of our code.\n\nIn a sense, code coverage is analogous to taking the pessimistic approach on the \"half-empty, half-full\" glass rhetoric — paying attention to the empty part (the untested areas), not the full part (what has already been covered).\n\n![Focus on the 15% of the unfilled parts. Photo by Engin Akyrut from Unsplash](https://res.cloudinary.com/namchee/image/upload/v1725083488/posts/embracing-code-coverage-effectively/glass-of-water)\n\n## Final Thoughts\n\nAt the end of the day, code coverage is just a tool and shouldn&apos;t be treated as the all-purpose metric of tests.\nWe should instead use it at what it does best: finding untested part of the code.\n\nWhen talking about the importance about the untested part of the code, [Brian Marrick](http://www.exampler.com/testing-com/writings/coverage.pdf) has an interesting take on it:\n\n> If a part of your test suite is weak in a way that coverage can detect, it&apos;s likely also weak in a way coverage can&apos;t detect.\n\nRather than limiting its effectiveness by using it as **the** metric of tests, I believe the correct approach for code coverage is\naugmenting it with other types of coverage, such as state coverage (which I will be writing about in the future).","posts/embracing-code-coverage-effectively.mdx","7594196b92368aa5","hello-world",{"id":49,"data":51,"body":56,"filePath":57,"digest":58,"deferredRender":22},{"title":52,"subtitle":53,"tags":54,"publishedAt":55,"isDraft":34},"Hello World!","Reflections of career and future plans",[17],["Date","2023-12-17T00:00:00.000Z"],"import DescriptionList from '@/components/astro/modules/posts/html/DescriptionList.astro';\nimport DescriptionTerm from '@/components/astro/modules/posts/html/DescriptionTerm.astro';\nimport DescriptionItem from '@/components/astro/modules/posts/html/DescriptionItem.astro';\n\nAfter three years of my career as a professional software engineer, I've finally decided that it's time for me to write\nand share my journey in the world of software engineering through this website.\n\nBut why? Why now instead of one or two years ago on the beginning of my career?\nWhat motivates me to begin at this particular moment?\n\nTo understand my motivations, let's take a trip down memory lane.\n\n## A Flashback to the Past\n\nIn the beginning days of my software engineering journey, I own a personal website that I built from scratch\nin [May of 2022](https://github.com/Namchee/site/tree/1b54cab8ce574ceb11f69d727547324f42a67b55).\nThe resulting website is a barebone website with a short self-introduction and a showcase of personal projects\nmasked with fancy CSS and JS visual tricks without any care for UI and UX principles.\n\n![A screenshot of the old version of namchee.dev](https://res.cloudinary.com/namchee/image/upload/v1/posts/hello-world/old-web)\n\nBack then, my reason for building my old website was to showcase my (admittedly lacking) skills in web development.\nAside from a showcase, I treated my old website as my personal code playground to test\nexperimental ideas that popped into my head, as evidenced by the amount of UI interactions I slapped on it.\n\nAt first, I believed that my old website would help me grow as a software engineer. However, I soon lost\ninterest in keeping it alive since it was just a collection of random ideas and whatever trends mashed up together in\nwhim without more polished thoughts put on it.\n\nUltimately, I feel like the old personal website didn't contribute to my growth as a software engineer.\nIn the end, I made a decision to abandon ship completely and build this website from scratch.\n\nWhile building this website, I spent a considerable amount of time contemplating the reasons behind the failure\nof my previous website to support my growth, despite being a personal playground for me to explore and test my ideas.\nPart of the reason was the lack of commitment.\nHowever, the most crucial factor was that I learned almost nothing from building my old website.\n\nAt this point, I received a hard lesson that creating my personal website isn't enough to accelerate my growth as a professional software engineer.\nWhat makes people learn then? Pondering for answers for days, I accidentally stumbled upon [learning in public](https://www.swyx.io/learn-in-public).\nAfter reading the article, I finally found out the missing part of my learning journey &mdash; the **feedback loop**.\n\n## The Feedback Loop\n\nProfessionals who strive to excel in their respective fields know that learning is a lifetime process. As an aspiring software engineer,\nI understand this and truly enjoy the continuous learning process every day. However, what I failed to recognize during my previous journey was the type\nof learning I was doing &mdash; **learning in private**.\n\nWhile learning in private isn't necessarily bad, it's not the kind of learning that boosts your growth. By learning in private, you walled yourself out\nfrom the community and missed out on feedback.\n\nEmbarking on a learning journey can feel daunting, and having something that got your back is crucial. It's normal to lack knowledge or expertise in the subject you're learning\nor to want to expand your understanding. The quickest way to gain knowledge or expertise is by learning from someone or something with more experience, either directly\nor indirectly. However, this is not possible if you walled yourself out from the community by learning in private.\n\nNow another problem arises — how could you get another entity to bestow you the knowledge you seek? Doing it passively by enclosing yourself in your personal haven won't work\nsince nobody will bat an eye if you are a nobody, which is expected when you're still on the first step of your learning journey. Even if you are not a nobody, no one\nwill bat an eye since they don't know what you are trying to achieve. In conclusion, the best way to do this is by actively **sharing** what you are currently doing,\nwhich is the core concept of learning in public.\n\nBy **continously sharing** what you are learning in public, you can **continuously receive feedback** to fuel up your learning cycle and grow continuously.\n\n![The continuous learning loop](https://res.cloudinary.com/namchee/image/upload/v1/posts/hello-world/continuous-learning)\n\nAs a software engineer, learning in public doesn't just mean open-sourcing whatever you're working on and leaving it as-is. Software engineers must also involve\nthemselves in the community by opening themselves to feedback, which is missing from my approach to learning in my previous attempt.\n\n## The Blueprint\n\nMoving on from the philosophical part of this post, I want this website to be my personal platform to learn in public. Specifically, this website will serve as:\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    Knowledge Base\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    Imagine having a personal library that stores records of all your experiences. Whenever I encounter a problem, I can trace back my logs and check if I have solved similar\n    issues in the past. Not only will it help me resolve my issue faster by reducing redundancy, scouring past logs will also enable others who might encounter similar problems\n    to solve them. In the end, everyone is happy!\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Code Playground\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    Since I found my past experiments to be insightful, I will continue my code playground and share ideas or experiments I've conducted as either code snippets or posts.\n    Hopefully, I can test out my ideas and sharpen them through public feedback. Don't be shy to drop feedback!\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Giving Back Platform\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    I owe a lot for my current position to the open-source community. This website and all its contents will serve as a thank-you letter to the open-source community\n    and keep the open-source spirit alive.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>Productive Distraction\u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    In the past, I used to play too much video games during my free time. However, I later realized that this activity was unproductive for my growth as a software engineer.\n    Therefore, I vow to replace it with more productive habits by maintaining this website.\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\n## Final Thoughts\n\nWith that in mind, I hope that everyone, including you who is reading this, can continuously learn and grow through this website.\n\nI know, I'm very late in the blogging game when a lot of people already started learning in public early in their careers. However, I believe that it is better to start late than never start at all. Cheers!","posts/hello-world.mdx","6fbd4ddb56de4db1","reflections-on-my-2024",{"id":59,"data":61,"body":66,"filePath":67,"digest":68,"deferredRender":22},{"title":62,"subtitle":63,"tags":64,"publishedAt":65,"isDraft":34},"Reflections on My 2024","Things I've done in 2024 and my expectations for 2025",[17],["Date","2025-01-15T00:00:00.000Z"],"import Tweet from 'astro-tweet';\nimport { BlueskyPost } from 'astro-embed';\n\nimport DescriptionList from '@/components/astro/modules/posts/html/DescriptionList.astro';\nimport DescriptionTerm from '@/components/astro/modules/posts/html/DescriptionTerm.astro';\nimport DescriptionItem from '@/components/astro/modules/posts/html/DescriptionItem.astro';\n\n\nIt's been 13 months since I wrote my [first blogpost](https://www.namchee.dev/posts/hello-world/) in 2023, and now we're already in 2025.\nIf you do the math, that's a 2-year gap between the blog debut and this year. What happened to my 2024?\n\n## Growing This Website\n\nWhen I first started this website in the end of 2023, it didn't have a design system yet. Back then, I only standardized the color scheme and the font family to be used.\nThe rest of it was just *how should the website generally look like*.\n\nAs I began pouring more content in this website, I realized that not having a design system slows down my pace as I began to notice the discrepancies between pages.\nOne day, it might be the color that's a bit off; the next day it might be the spacings; and so on.\n\nRealizing this, I spent a lot of time building a [more concrete design system](https://github.com/Namchee/site/pull/56) for this website along with public branding elements\nsuch as [dynamic OG images](https://github.com/Namchee/site/pull/38). I'm quite happy with the result as I no longer overthink the styling and can focus on the content of the site.\n\n![The current state of the design file. While there's still room for improvements, it's servicable and systematic](https://res.cloudinary.com/namchee/image/upload/v1736691416/posts/reflections-on-my-2024/design-file.png)\n\nSpeaking of content, I wrote [3](https://www.namchee.dev/posts/embracing-code-coverage-effectively/) [blog](https://www.namchee.dev/posts/utilpocalypse/)[post](https://www.namchee.dev/posts/upgrading-astro-code-snippets/) in 2024.\nAll were engineering-related, but with varying topics. It's not much, but I think it's a good start.\n\n## Open Source Activities\n\nMy biggest open source contribution in 2024 was to [e18e](https://e18e.dev/), an initiative aimed at addressing performance issues in the JavaScript ecosystem, which I stumbled upon from social media.\n\n\u003CBlueskyPost id=\"https://bsky.app/profile/e18e.dev/post/3laofvnjipk25\" />\n\nWhile I didn't handle the heavy lifting, such as maintaining the initiative or developing leveled-up libraries, I contributed by\n[migrating an obsolete dependency](https://e18e.dev/blog/october-contributions-showcase.html#strip-ansi) on various high-profile repositories.\nIn the process, I learned a lot from the inner workings of the projects I contributed to.\n\nI honestly didn't expect much from e18e at the beginning, but I'm happy that this community has exceeded my expectations.\nNot only as a place to coordinate the initiative, I've 'stolen' a lot of libraries and technique that I didn't know existed just from hanging out in the [Discord server](https://chat.e18e.dev/).\n\nIn short, I see e18e as a place where developers who genuinely cares about the state of JavaScript gathers and contribute to make the ecosystem better.\nDon't be shy to join us as we don't bite newcomers (at least I think [patak](https://patak.dev/) and [43081j](https://43081j.com/) don't)\n\nBesides contributing to community initiatives, I've also worked on some shiny new side-projects:\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    [j2v](https://github.com/Namchee/j2v)\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    **j2v** is a small CLI tool that helps migrate your [Jest](https://jestjs.io/) test suite\n    to [Vitest](https://vitest.dev/) automatically via codemods.\n\n    I initally created this for my company, but I decided to share it publicly.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    [astro-subfont](https://www.npmjs.com/package/@namchee/astro-subfont)\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    **astro-subfont** is a plugin for Astro that optimizes your typefaces by [subsetting](https://fonts.google.com/knowledge/glossary/subsetting)\n    them based on the build output using [subfont](https://github.com/Munter/subfont).\n\n    This integration is used on this website!\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    [instablitz](https://github.com/Namchee/instablitz)\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    **instablitz** is a [Visual Studio Code](https://code.visualstudio.com/) plugin that exports your workspace\n    to [Stackblitz](https://stackblitz.com/) directly from your IDE.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    [tailwind-pointer-queries](https://github.com/Namchee/instablitz)\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    **tailwind-pointer-queries** is a work-in-progress [TailwincCSS](https://tailwindcss.com/) plugin that adds the missing\n    [CSS pointer query](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/pointer) as a [variant](https://tailwindcss.com/docs/plugins).\n\n    Since I've discovered other niche [media queries](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_media_queries/Using_media_queries)\n    that aren't currently available as a Tailwind variant, I plan to expand the scope of this project to include those missing queries.\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\n## New Hardware\n\nIn February 2024, I short-circuited my G14 laptop by accident while I was trying to replace the thermal paste due to high temps.\nI was devastated, as it was my only device and the repair cost was almost exactly the same as buying a new one.\n\nSince spending a lot of money to 're-buy' my laptop didn't seem wise, I had to settle with\nusing only my work device to code for a while. This incident led me to vow never to rely on a laptop as my primary development device again.\n\nOn September 2024, I finally decided to treat myself by building a PC that serves as my primary device for coding.\n\n![The parts I used to build my PC](https://res.cloudinary.com/namchee/image/upload/q_auto,w_1024/v1736767488/posts/reflections-on-my-2024/pc-parts)\n\nAside from building my own PC, I also decided to upgrade my workspace peripherals, including a 27-inch IPS monitor and\na programmable, hot-swappable mechanical keyboard.\n\nWhile I was quite skeptical at first, the ergonomics provided by these new peripherals bring are simply unbeatable compared\nto peripherals that I used previously, which in turn made me more comfortable during long coding sessions.\n\n![My current workstation. Do forgive those dangling cables.](https://res.cloudinary.com/namchee/image/upload/v1736776657/posts/reflections-on-my-2024/my-workstation)\n\n## Advent of TypeScript\n\nFinally, I closed out the year by participating in [Advent of TypeScript](https://www.adventofts.com/events/2024), which is essentially an [Advent of Code](https://en.wikipedia.org/wiki/Advent_of_Code)\ndesigned to be tackled via [TypeScript](https://www.typescriptlang.org/) type system. This wasn't my first time participating, as I also joined the [first Advent of TypeScript](https://www.adventofts.com/events/2023).\n\nThe 2024 event focused more on the practicality of the type system that can be used in real-life projects as opposed to esotericism of the 2023 event.\n\nThe days that really made an impression on me were the [23rd](https://www.adventofts.com/events/2024/23) and [24th](https://www.adventofts.com/events/2024/24) day challenge, where\nwe are challenged with writing a higher-order function using the type system only. I personally didn't know that it was possible to do this with just the type system!\n\nIn the end, I placed quite high in the final leaderboard, but what matters the most to me is the knowledge that I gained from doing this event. So, I'd like to say\nthanks to [trash](https://x.com/trashh_dev) and the [TypeHero](https://typehero.dev/) team for organizing this event!\n\n![The final leaderboard of Advent of TypeScript 2024. I placed 4th!](https://res.cloudinary.com/namchee/image/upload/v1736778107/posts/reflections-on-my-2024/aots-leaderboard)\n\n## Regrets of 2024\n\nWhile I think 2024 was a pretty good year for both my career and personal life, I do have some regrets that I want to avoid in 2025\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    Not Building Enough Personal Branding\n  \u003C/DescriptionTerm>\n\n  \u003CDescriptionItem>\n    In my first blogpost, I [mentioned that I want to use this website as my learning-in-public platform](http://www.namchee.dev/posts/hello-world#the-feedback-loop), I realized that I didn't do\n    much in terms of being public, as evidenced by the site metrics provided by [Umami](https://umami.is/)\n\n    ![namchee.dev metrics in 2024. Notice that it only spiked on the end of 2024](https://res.cloudinary.com/namchee/image/upload/v1736866238/posts/reflections-on-my-2024/site-metrics.png)\n\n    While I do learn a lot of things over the course of 2024, I only shared those insights in a closed Discord environment and didn't fully utilize my social media accounts ([Bluesky](https://bsky.app/profile/namchee.dev), after migrating from X)\n    to the fullest.\n\n    The number of blog posts that I wrote in 2024 also didn't contribute much to my personal branding, as I rarely published anything, despite having a lot of topics to write about in my backlog.\n\n    Looking back, the main reason why I didn't publish much was because I became too focused on the quality and uniqueness of my content, to the point where I ended up not publishing anything at all.\n\n    Instead, I should have focused on writing and publishing posts first, leaving improvements for later.\n    After all, I'm in full control of this website, so I shouldn't feel blocked when improving existing contents.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Not Enough Self Investment\n  \u003C/DescriptionTerm>\n\n  \u003CDescriptionItem>\n    In 2024, I've [finished reading 5 books](https://www.namchee.dev/library/) with 1 still in progress. While it's comparable to 2023, I feel\n    that I haven't done enough as I neglected investing in my hard skills in practice.\n\n    At the beginning of the year, I planned to expand my language repertoire by learning [Zig](https://ziglang.org/) or [Rust](https://www.rust-lang.org/)\n    and improve my front-end game by learning [Three.js](https://threejs.org/). Unfortunately, I spectacularly failed at all of them with various made-up excuses.\n\n    In 2025, I plan to take a more extreme measure by taking a paid course to ensure my accountability.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Not Maintaining Existing Projects\n  \u003C/DescriptionTerm>\n\n  \u003CDescriptionItem>\n    If you take a look at the commit history of my showcased project, like [OJK Invest API](https://github.com/Namchee/ojk-invest-api), you'll notice that I haven't made any updates to it, despite a\n    lingering bug on the data extractor.\n\n    What's worse, the scrapers didn't actually work until I realize it in [May 2024](https://github.com/Namchee/ojk-invest-api/pull/63)!\n\n    ![Commit History of OJK Invest API. It feels bad to neglect bugs for an entire year](https://res.cloudinary.com/namchee/image/upload/v1736951045/posts/reflections-on-my-2024/commits-ojk)\n\n    While sometimes it's OK to put projects on freeze and move on, I feel that I can still do *more* with my old projects and I believe that a good engineer is not only someone who writes good software, but also someone who maintains it well.\n\n    In 2025, I plan to slow down on starting new projects and invest more time on addressing debts in my old projects.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Not Enough Exercise\n  \u003C/DescriptionTerm>\n\n  \u003CDescriptionItem>\n    Lastly, I didn't exercise enough in 2024 and it's starting to take its toll by the end of 2024, as I feel more sluggish compared to the beginning of the year.\n\n    In 2025, I planned to make myself more accountable of my own health by tracking my exercise history on my phone through [Google Fit](https://www.google.com/fit/)\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\n## Final Thoughts\n\nAnd that's a wrap for 2024! While the year had some disappointing downs, 2024 was a meaningful year for me both personal and professional wise. I hope that I can\nlearn from my regrets and improve on 2025.","posts/reflections-on-my-2024.mdx","fcfdd0f3aae7af23","the-quest-for-perfect-freeform-input",{"id":69,"data":71,"body":77,"filePath":78,"digest":79,"deferredRender":22},{"title":72,"subtitle":73,"tags":74,"publishedAt":76,"isDraft":34},"The Quest For Perfect Freeform Input","Will the new plaintext-only replace textarea?",[32,75],"CSS",["Date","2025-06-08T00:00:00.000Z"],"March 2025 has brought us a new update to the web platform: the induction of `plaintext-only` value for\n`contenteditable` attribute to [Widely Available Baseline](https://web.dev/blog/contenteditable-plaintext-only-baseline),\nwhich is a prevalent attribute commonly used in rich-text editors.\n\nFrom what we can discern from the name alone, `plaintext-only` seems to strip down all rich-text formattings\nfrom values inside `contenteditable` into plaintexts.\n\nHowever, won't that defeat the purpose of `contenteditable` in the first place? Moreover, we already have good old\n`\u003Ctextarea>` to handle freeform inputs. What is WHATWG trying to solve when introducting this new value?\n\n## When Textarea Isn't Enough\n\nSince its introduction of HTML2 in [November 1995](https://www.w3.org/MarkUp/html-spec/), freeform inputs has always\nbeen traditionally defined with the `\u003Ctextarea>` element instead of `\u003Cinput>`.\n\n\u003Cfigure class=\"my-4 w-full max-w-4/5 mx-auto\">\n  \u003Ctextarea class=\"border border-separator p-2 font-mono w-full bg-background transition-colors\" placeholder=\"Hello, I'm textarea 👋\">\u003C/textarea>\n  \u003Cfigcaption class=\"text-xs italic text-center\">An example of textarea with minimal setup\u003C/figcaption>\n\u003C/figure>\n\nThe main difference between `\u003Ctextarea>` and `\u003Cinput>` element beside the wrapping behavior is the additional handle on the bottom right\nof the element for resizing and the addition of `rows` and `cols` attribute that controls the initial size of the element.\n\nAs you started adopting `\u003Ctextarea>`, you will begin to realize that your styling options to the contents inside the `\u003Ctextarea>`\nis only limited to inherited attributes that you can define in `\u003Ctextarea>`.\n\nContents inside `\u003Ctextarea>` are treated the same way as [replaced elements](https://html.spec.whatwg.org/multipage/rendering.html#replaced-elements),\nthey have their own intrinsic dimensions and it's up to the user agent to control how the contents are rendered.\n\nJust like `\u003Cinput>`, the user agent internally uses [Shadow DOM](https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_shadow_DOM)\nto isolate the contents of `\u003Ctextarea>` into its own DOM tree.\n\n![User agent Shadow DOM that encapsulate the contents of textarea (need to explicitly enable in DevTools)](https://res.cloudinary.com/namchee/image/upload/v1748674003/posts/the-quest-for-perfect-plaintext-input/textarea-shadow-dom)\n\nSince the contents largely exist outside the developer-controlled [CSS rendering model](https://www.w3.org/TR/WD-CSS2/visuren.html),\n`\u003Ctextarea>` lacked the native capability to automatically resize itself which is a common usecase for modern UI interfaces.\n\nTo address this issue, developers usually handles it with JavaScript in similar fashion as the following:\n\n```js title=textarea.js\nconst textarea = document.querySelector('.textarea__autosize');\n\nfunction resizeTextarea(el) {\n  // Reset textarea height to auto to correctly calculate the new height\n  el.style.height = 'auto';\n  const newHeight = el.scrollHeight;\n\n  el.style.height = `${newHeight}px`;\n  el.style.overflowY = 'hidden';\n\n  /**\n   * If you want autosize to a certain max number of rows:\n   *\n   * const MAX_ROWS = 8;\n   *\n   * // Calculate maximum height from maxRows\n   * const lineHeight =\n   *   parseInt(window.getComputedStyle(el).lineHeight, 10) || 0;\n   *\n   * const maxHeight = lineHeight * maxRows;\n   *\n   * if (newHeight > maxHeight) {\n   *   el.style.height = `${maxHeight}px`;\n   *   el.style.overflowY = 'scroll';\n   * }\n   */\n}\n\ntextarea.addEventListener('input', () => resizeTextarea(el));\n```\n\nWhile the autosizing implementation above works, it introduces 2 new problems:\n\n- Reliance to JavaScript, even though `\u003Ctextarea>` works fine without it\n- Developers must manually wire autosizing logic to various HTML events like `paste` or direct value changes via `.innerHTML`.\nOtherwise, the `\u003Ctextarea>` may not resize correctly, which might hurt the UX.\n\n> In the future, we might not need to manually handle autosizing in `\u003Ctextarea>` due to\nthe introduction of `field-sizing`. At the moment however, it's only supported in Chromium-based browsers.\n\nAs for the list of other CSS features that don't work at all in `\u003Ctextarea>` without some wizardy due to Shadow DOM encapsulation:\n\n- `::before` and `::after` pseudo element\n- `caret-color`\n- Scrollbar-related styling prefixed with `-webkit-scrollbar`\n- [CSS Highlight API](https://developer.mozilla.org/en-US/docs/Web/API/CSS_Custom_Highlight_API)\n\nTo address the issues with `\u003Ctextarea>`, developers tend to replace their freeform inputs with\na `contenteditable` element even when rich-text formatting isn't needed.\n\nHowever, many people who haven't dealt with `contenteditable` before don't\nrealize that `contenteditable` comes with its own set of problems compared to `\u003Ctextarea>` until\nthey've delved too far with it.\n\n## Contenteditable: New Set of Problems\n\nIf you're not living in a cave in the past decade, you might notice that some of the freeform input inside\nyou favorite apps are capable of rendering wider variety of style and formats unlike what `\u003Ctextarea>` can provide with plaintext.\n\nRich-text capabilities like that are commonly provided by `contenteditable`, which can usually be seen in discussion forums and social media platforms.\n\n![Bluesky post editor using contenteditable. Powered by ProseMirror](https://res.cloudinary.com/namchee/image/upload/v1748700530/posts/the-quest-for-perfect-plaintext-input/bsky)\n\nThe attribute itself is surprisingly old, as it's first introduced in July 2000 by Microsoft alongside `designMode` through Internet Explorer\n([RIP](https://techcommunity.microsoft.com/blog/windows-itpro-blog/internet-explorer-11-desktop-app-retirement-faq/2366549)) 5.5.\n\nThe details were pretty lacking, but Ian Hickson wrote a [WHATWG blogpost](https://lists.whatwg.org/pipermail/whatwg-whatwg.org/2004-November/002313.html)\noutlining the main purpose of these new attributes: extending the capability of `\u003Ctextarea>` for\nrich-text formatting in general like WYSIWYG editors.\n\nWhile `designMode` makes the *entire document* editable, `contenteditable` isolate the editability to a certain element.\nUsually, a `\u003Cdiv>` is used as a container for a freeform input defined with `contenteditable`.\n\n\u003Cfigure class=\"my-4 w-full max-w-4/5 mx-auto\">\n  \u003Cdiv\n    contenteditable\n    class=\"border border-separator p-2 font-mono w-full bg-background transition-colors contenteditable__autoresize\"\n    role=\"textbox\"\n    placeholder=\"Hello, I'm a contenteditable div 👋\"\n    aria-placeholder=\"Hello, I'm a contenteditable div 👋\"\n  />\n  \u003Cfigcaption class=\"text-xs italic text-center mt-2\">An example of contenteditable div with minimal setup\u003C/figcaption>\n\u003C/figure>\n\nAside from rich-text formatting that `\u003Ctextarea>` can't do, you might realize that the container element automatically resize itself\nwhen the contents inside are mutated.\n\nUnlike `\u003Ctextarea>`, `contenteditable` doesn't use Shadow DOM *by default* and its contents exist inside the normal DOM tree.\nAs a result, it supports broader CSS features than `\u003Ctextarea>`, such as those mentioned the previous section.\n\nDue to its wider CSS support, it's much easier to apply advanced styling to `contenteditable` without JavaScript, such as\nas limiting autosizing to a maximum number of lines until overflow with only pure CSS:\n\n```css title=contenteditable.css, copy\n:root {\n  /* Assume that we want a maximum of 8 lines before resizing */\n  --maximum-lines: 8;\n}\n\n.contenteditable__autoresize {\n  line-height: 1.5;\n  min-height: calc(4rem + 16px);\n  max-height: calc(var(--maximum-lines) * 1.5rem + 16px);\n  overflow: auto;\n  /* Ensure no width transition when scrollbar appears */\n  scrollbar-gutter: stable;\n}\n\n/* Emulate \u003Ctextarea> placeholder */\n.contenteditable__autoresize:empty::before {\n  content: attr(placeholder);\n  opacity: 0.5;\n  pointer-events: none;\n}\n```\n\nOn the surface, `contenteditable` seems like an upgrade to `\u003Ctextarea>` with rich-text capabilities and broader CSS feature support.\nHowever, playing around `contenteditable` reveals plethora of problems that `\u003Ctextarea>` doesn't have:\n\n- `contenteditable` isn't a form control element, which means no *native* `\u003Clabel>` and `placeholder` support.\n- Interacting with `contenteditable` element as a form value requires JavaScript.\n- Accessibility need to be handled manually through ARIA attributes, which usually is\n[forgotten or handled incorrectly](https://webaim.org/projects/million/).\n- Inconsistent many-to-one representation of rich-text to HTML elements, making it not well-behaved and hard to determine equality.\n- Invisible element such as additional `\u003Cbr />` in an empty `contenteditable` and occassional `\u003Cspan>` must be taken into account\nbefore processing the contents.\n- Pasting contents to the element might cause unexpected result as foreign rich-text formats are included in the clipboard.\n- [Various cross-browser behavior inconsistencies](https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md)\n\n[To avoid frustration](https://ckeditor.com/blog/ContentEditable-The-Good-the-Bad-and-the-Ugly/) with `contenteditable`, seasoned developers\nusually just pick a mature library to handle rich-text editing such as [CKEditor](https://ckeditor.com/), [ProseMirror](https://prosemirror.net/),\n[TinyMCE](https://www.tiny.cloud/), any many more similar libraries.\n\nThose who avoid libraries and care about consistency will spend most of their time building a model, rendering schema, and mapping rules for\n`contenteditable` &mdash; something small teams often can't afford to do.\n\n## Plaintext-only Do Too Little\n\nGoing back to the previous section, one of the problems that `contenteditable` have is dealing with pasted inputs.\n\nSince we don't know the source of the clipboard, the pasted contents might misbehave due to containing rich-text elements\nthat we don't support.\n\nBeside suggesting the users to use plaintext paste, there are 2 alternatives that can be used to solve this problem:\n\n- Re-map all supported rich-text elements to your content model and strip the rest of unsupported elements. This method requires\nmore code.\n- Strip all rich-text elements, pasting them as plaintext.\n\nStripping rich-text elements from the clipboard before pasting can be done by listening to `paste` event in JavaScript:\n\n```js title=Removing rich-text from paste event, copy\nconst contenteditable = document.querySelector(\n  '.contenteditable__autosize'\n);\n\ncontenteditable.addEventListener('paste', (e) => {\n  e.preventDefault();\n\n  // remove text formatting from clipboard\n  const pastedText = (e.clipboardData || window.clipboardData).getData('text/plain');\n\n  // get the current caret position\n  const selection = window.getSelection();\n  if (!selection.rangeCount) {\n    return;\n  }\n\n  // remove the selected text first!\n  selection.deleteFromDocument();\n  selection.getRangeAt(0).insertNode(document.createTextNode(pastedText));\n\n  selection.collapseToEnd();\n});\n```\n\nRecent development on web platform introduces us to `plaintext-only` value for `contenteditable` while the old behavior\nis usually referred as `true`.\n\nWhat it basically do is it strips all rich-text formatting from the clipboard payload\nbefore applying the value to the input which you can try from the following element:\n\n\u003Cfigure class=\"my-4 w-full max-w-4/5 mx-auto\">\n  \u003Cdiv\n    contenteditable=\"plaintext-only\"\n    class=\"border border-separator p-2 font-mono w-full bg-background transition-colors contenteditable__autoresize contenteditable__plaintext min-h-16\"\n    role=\"textbox\"\n    placeholder=\"Hello, I'm a plaintext-only contenteditable div 👋\"\n    aria-placeholder=\"Hello, I'm a plaintext-only contenteditable div 👋\"\n  />\n  \u003Cfigcaption class=\"text-xs italic text-center mt-2\">An example of contenteditable div, but plaintext\u003C/figcaption>\n\u003C/figure>\n\nContrary to its name, `plaintext-only` doesn't remove rich-text capabilities from `contenteditable`. The feature is still\nsupported as evidenced by rendering HTML elements inside `contenteditable` through `.innerHTML`.\n\nWhile it does offer a no-code solution for rich-text clipboard problem, it doesn't\nsolve the meat of the problem with `contenteditable`: inconsistent rendering and native form control support.\n\n## Choosing Your Own Poison\n\nWe now have 2 alternatives to represent freeform input elements: `\u003Ctextarea>` and `contenteditable`. But how should you determine\nwhich one to use?\n\nFortunately, choosing between 2 alternatives for freeform inputs can be simplified by answering the following question:\n*do you need rich-text on your inputs?*\n\nIf the answer is **No**, just use `\u003Ctextarea>`. In my experience, `contenteditable` isn't worth considering just\nfor native autosize and some CSS feature support as you need to write a lot of extra code for `contenteditable` to behave itself.\n\nIf the answer is **Yes**, then ask yourself again: can you afford the additional development cost of using `contenteditable` considering\n[its inherent problems](#:~:text=However%2C%20playing%20around%20contenteditable%20reveals%20plethora%20of%20problems%20that%20%3Ctextarea%3E%20doesn%E2%80%99t%20have)?\n\nIf you **can afford the cost**, then design the rendering model, schema, and mapping while not forgetting about other quirks and custom features\nthat you need.\n\nIf you **cannot afford the cost**, consider using a mature rich-text libraries and define your input limitations to the rich-text schema.\n\nThe only scenario where I think it's okay to use a barebone `contenteditable` is when you're building a throwaway code or building\na simple proof-of-concept.\n\nIf you're asking me whether `plaintext-only` changed anything, I'm going to say **no**. The paste behavior\nis only one of the smaller, easily solvable problems and doesn't fix other problems with `contenteditable`.\n\nMoreover, I find the name `plaintext-only` a bit misleading since it doesn't transform\n`contenteditable` into a *plaintext-only* input, but it only provides a built-in handler for plaintext paste.\n\n## Final Thoughts\n\nWhile it looks like I antagonized `contenteditable` too much, I don't think that a vanilla `contenteditable` should be avoided\nat all cost as it's the simplest way to define a rich-text editor on the web.\n\nChoosing between `\u003Ctextarea>` and `contenteditable` can be imagined as getting a meal. The former is akin to ordering a take-out,\nbut your customization options are limited, maybe a few extra toppings or a different sauce.\n\nThe later is akin to buying raw ingredients and cooking food yourself without clear recipe. If you aren't a chef or at least a home cook, there's a good\nchance that you'll mess something up along the way *but* at least you can do *almost anything* to it.\n\nThat being said, it's important to *use the right tool for the job* and *be conscious of it*. If you don't need rich-texts, use a\n`\u003Ctextarea>`, else use a mature rich-text library and focus on other features instead of dealing with `contenteditable` quirks.","posts/the-quest-for-perfect-freeform-input.mdx","f0636f0541b47fe1","upgrading-astro-code-snippets",{"id":80,"data":82,"body":88,"filePath":89,"digest":90,"deferredRender":22},{"title":83,"subtitle":84,"tags":85,"publishedAt":87,"isDraft":34},"Upgrading Astro Code Snippets","Make the code snippet truly yours",[86],"astro",["Date","2024-12-25T00:00:00.000Z"],"Markdown is commonly used to store textual contents when building a site with Astro. During the build process, Astro will take\nall markdowns transform them into its HTML equivalent. Users can then style the markups with CSS however they wish.\n\nHowever, customization through CSS is pretty limited as customizing the actual markup or behavior is out of the table. To allow\ngreater degree of customization, users can opt-in to [MDX](https://docs.astro.build/en/guides/integrations-guide/mdx/).\n\nMDX allows users to utilize custom components with markup-like syntax similar to how we use those components in Astro files or JSX.\n\n```markdown title=Using custom components in MDX\n---\ntitle: 'Hello World!'\npublishedAt: 2024-12-17\n---\nimport MyComponent from 'path/to/component.astro';\n\n\u003CMyComponent>\n  Hello World!\n\u003C/MyComponent>\n```\n\nHowever, this is impractical when users want to replace default elements as they\nare forced to use JSX-like syntax for every element and lose the simplicity of defining elements in markdown.\n\nFortunately, MDX also allows users to re-map HTML elements into custom components\nby exporting component map in MDX files as `components` constant.\n\n\n```markdown title=Replacing default elements with custom elements,{8-11}\n---\ntitle: 'Hello World!'\npublishedAt: 2024-12-17\n---\n\nimport Head1 from 'path/to/Head1.astro';\n\nexport const components = {\n  // Replace \u003Ch1> with Head1\n  h1: Head1,\n}\n```\n\nAlternatively, users can also provide the mapped components by passing them as a prop to the `\u003CContent />` element\n\n```astro title=Passing component mapping via \u003CContent />,{6-8}\n---\nimport { Content } from 'path/to/Content.mdx';\nimport Head1 from 'path/to/Head1.astro';\n---\n\n\u003CContent components={{\n  h1: Head1,\n}}>\n```\n\nAfter seeing the syntax, you might be wondering: how do I manage the props? What attributes are passed to the mapped element?\nCan I apply a pre-defined CSS classes to mapped elements?\n\nUnfortunately, it seems that [Astro's MDX integration documentation](https://docs.astro.build/en/guides/integrations-guide/mdx/) only touches\nthe surface of this syntax and the [official MDX documentation](https://mdxjs.com/table-of-components/) only tells you about what elements\nthat can be re-mapped.\n\nThis post will guide you through customizing default markdown elements using the `components` syntax. We will using the default code snippets\ncomponent as the guinea pig and upgrade them into similar code snippets that you see in this site.\n\n![The default snippet. Looks great, but can we make it even better?](https://res.cloudinary.com/namchee/image/upload/v1734152131/posts/supercharing-astro-code-snippet/default-snippet.png)\n\n> I will be using [UnoCSS](https://unocss.dev/) for styling, which is an alternative of [TailwindCSS](https://tailwindcss.com/). However, the styling can 100% be implemented with vanilla CSS.\n\n## Deconstructing the Code Snippet\n\nBefore moving on to the actual customization of the snippet, we need to understand how Astro handles markdown files.\n\nFor each markdown file, Astro will parse the content using a processor called [remark](https://github.com/withastro/astro/tree/main/packages/markdown/remark),  which is a part of the\n[unified](https://unifiedjs.com/) toolchain. From the markdown, remark will produce an [abstract syntax tree](https://en.wikipedia.org/wiki/Abstract_syntax_tree) (AST). The AST will\nthen be transformed into HTML tags using another processor in the same toolchain: [rehype](https://github.com/rehypejs/rehype).\n\n> You might be wondering why we need to transform the markdown into an AST and not directly use something like RegExp.\n> \u003Cbr />\n> This is because markdown (and HTML) is not a [regular language](https://en.wikipedia.org/wiki/Regular_language). Trying to parse non-regular language with **regular** tends to be error prone.\n\nThe functionality of remark and rehype can be augmented using [plugins](https://unifiedjs.com/learn/guide/create-a-rehype-plugin/) that provides additional features,\nsuch as custom syntax and syntax highlighting.\n\nBy default, Astro enables [GitHub-flavored markdown](https://github.github.com/gfm/) and [SmartyPants](https://github.com/silvenon/remark-smartypants)\nplugin to extend the basic markdown syntax. For syntax highlighting, Astro uses [Shiki](https://shiki.matsu.io/packages/rehype) by default or\nusers can opt-in to [Prism](https://prismjs.com/); both available as Rehype plugins.\n\nThe diagram below shows a simplified pipeline of markdown transformation to HTML that occurs during the build process.\n\n```mermaid\nflowchart LR\n\tMarkdown --> astro[Astro Compiler]\n\tastro --> remark[Remark + Plugins]\n\tremark -- AST --> rehype(Rehype + Plugins)\n\trehype -- HTML tags --> astro\n\tastro --> page(HTML page)\n```\n\nWhen processing code blocks, the process above will output HTML tags similar to the following:\n\n```html title=Example HTML output of a code block after Remark + Rehype pipeline.\n\u003Cpre\n\tclass=\"astro-code github-dark\"\n\tstyle=\"background-color:#24292e;color:#e1e4e8;overflow-x:auto\"\n\ttabindex=\"0\"\n\tdata-language=\"js\"\n>\n\t\u003Ccode>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#F97583\">&lt;!\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">doctype html\u003C/span>\n      \u003Cspan style=\"color:#F97583\">&gt;\u003C/span>\n    \u003C/span>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#E1E4E8\">&lt;\u003C/span>\n      \u003Cspan style=\"color:#85E89D\">html\u003C/span>\n      \u003Cspan style=\"color:#B392F0\"> lang\u003C/span>\n      \u003Cspan style=\"color:#F97583\">=\u003C/span>\n      \u003Cspan style=\"color:#9ECBFF\">\"en\"\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">&gt;\u003C/span>\n    \u003C/span>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#E1E4E8\">  &lt;\u003C/span>\n      \u003Cspan style=\"color:#85E89D\">head\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">&gt;\u003C/span>\n    \u003C/span>\n    \u003C!-- and the rest of the tags -->\n\t\u003C/code>\n\u003C/pre>\n```\n\nThis HTML tags will then be used by Astro to replace code blocks during the markdown\ntransformation process into an HTML page for:\n\n- All code fences (\\`\\`\\`) defined in Markdown and MDX files.\n- Content defined with `\u003CCode />` or `\u003CPrism />` component.\n\n## Replacing The Default Code Snippet\n\nOur first step to customize the code snippet is by replacing the default component with\na custom component that wraps the original one using Astro `\u003Cslot />`.\n\nTo do that, we can assign a custom mapping for HTML elements by exporting a new constant\ncalled `components` in our MDX files.\n\n```markdown title=hello-world.mdx,{8-11}\n---\ntitle: 'Hello World!'\npublishedAt: 2024-12-17\n---\n\nimport CodeSnippet from '../../components/CodeSnippet.astro';\n\nexport const components = {\n\t// in MDX, code snippets are defined with \u003Cpre>\n\tpre: CodeSnippet,\n}\n```\n\nWe can then define `CodeSnippet` as:\n\n```astro title=CodeSnippet.astro\n\u003Cfigure>\n\t\u003Cfigcaption>\n    This is a caption\n\t\u003C/figcaption>\n\n\t\u003Cslot />\n\u003C/figure>\n```\n\nSave the file and we will be greeted by this weird element.\n\n![Well... that was unexpected](https://res.cloudinary.com/namchee/image/upload/v1734274270/posts/supercharing-astro-code-snippet/first-try)\n\nSo what's happening here? Why does wrapping the code block in a `\u003Cfigure>` element ruins the structure entirely? Well it turns out, we replaced\nthe entire `\u003Cpre>` element with `\u003Cfigure>` as shown in the following snippet.\n\n```html title=HTML output of CodeSnippet.astro\n\u003Cfigure>\n\t\u003Cfigcaption>\n    This is a caption\n\t\u003C/figcaption>\n\n  \u003C!-- The \u003Cpre> is gone! -->\n\n  \u003Ccode>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#F97583\">&lt;!\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">doctype html\u003C/span>\n      \u003Cspan style=\"color:#F97583\">&gt;\u003C/span>\n    \u003C/span>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#E1E4E8\">&lt;\u003C/span>\n      \u003Cspan style=\"color:#85E89D\">html\u003C/span>\n      \u003Cspan style=\"color:#B392F0\"> lang\u003C/span>\n      \u003Cspan style=\"color:#F97583\">=\u003C/span>\n      \u003Cspan style=\"color:#9ECBFF\">\"en\"\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">&gt;\u003C/span>\n    \u003C/span>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#E1E4E8\">  &lt;\u003C/span>\n      \u003Cspan style=\"color:#85E89D\">head\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">&gt;\u003C/span>\n    \u003C/span>\n    \u003C!-- and the rest of the tags -->\n  \u003C/code>\n\u003C/figure>\n```\n\nWell, that's **not** what we wanted at all! We don't want to remove the `\u003Cpre>` entirely as we need to preserve\nthe preformatted styling. After wrapping the `\u003Ccode>` block inside a `\u003Cpre>` element, the previously\nbutchered element will look like this.\n\n![Look ma! I restored the formatting!](https://res.cloudinary.com/namchee/image/upload/v1734770479/posts/supercharing-astro-code-snippet/second-try)\n\nWe've restored the formatting at this point, but we're still missing the theming from the original component. Obviously, we can apply the intended\nclass, style, and other attributes to the `\u003Cpre>` element directly. However, this means that we wasted the theming we've done from Astro's config entirely.\n\nFortunately, since the custom component is implemented as an Astro component, Astro treats those passed attributes as **component props** which is\nprovided by `Astro.props` globals.\n\n```astro title=CodeSnippet.astro,{2,10}\n---\nconst props = Astro.props;\n---\n\n\u003Cfigure>\n  \u003Cfigcaption>\n    This is a caption\n  \u003C/figcaption>\n\n  \u003Cpre {...props}>\u003Cslot />\u003C/pre>\n\u003C/figure>\n```\n\nwhich results in\n\n![Passing the `props` surely do the trick](https://res.cloudinary.com/namchee/image/upload/v1734792284/posts/supercharing-astro-code-snippet/third-try)\n\nWe did it! We've successfully rendered a custom code snippet component without breaking the existing components. We can now begin customizing the component.\n\n## Supercharging The Code Snippet\n\nSince we have successfully replaced the default code block with our custom element, it's time to upgrade our components with the following additional features:\n\n- Captions\n- Line Numbers\n- Line or Code Highlighting\n- Show Code Language\n- Copy to Clipboard Button\n\nBefore we implement these new features however, there is one important trick that we should know: passing additional props.\n\n### Passing Additional Props to Code Snippet\n\nIn the previous section, all we did with the props is passing an already defined props. However, some of our additional properties requires\nadditional information that Shiki doesn't provide by default (namely captions and copy to clipboard).\n\nThe good news is, Shiki already addresses this issue by giving users the ability to add [metadata](https://shiki.style/guide/transformers#meta) to code blocks that users can provide\nin the opening tag after language definition.\n\nThe bad news is, Shiki integration in Astro doesn't pass them to the element in any form, so trying to access `Astro.props` to get the extra metadata will yield nothing.\n\n```markdown title=Trying to pass 'title' as a metadata to the component (it doesn't work!)\n\u003C!-- ```html foo --->\n\u003C!doctype html>\n\u003Chtml lang=\"en\">\n  \u003Chead>\n    \u003Cmeta charset=\"utf-8\" />\n    \u003Ctitle>Example HTML5 Document\u003C/title>\n\t\u003C/head>\n  \u003Cbody>\n    \u003Cp>Test\u003C/p>\n  \u003C/body>\n\u003C/html>\n\u003C!-- ``` -->\n```\n\nSince Astro doesn't pass metadata by default, we need to play around with the [Shiki Transformer API](https://shiki.matsu.io/guide/transformers) to create a transformer\nthat passes the metadata as an attribute. Fortunately, it's quite simple to do so through `shikiConfig` that Astro exposes.\n\n```js title=astro.config.mjs,{8}\nimport { defineConfig } from 'astro/config';\n\nexport default defineConfig({\n  markdown: {\n    shikiConfig: {\n      transformers: [{\n        pre(hast) {\n          hast.properties['data-meta'] = this.options.meta?.__raw;\n        }\n      }]\n    }\n  },\n});\n```\n\nWith the above config, Shiki will pass the metadata as an HTML property `data-meta` which can then be accessed normally through\n`Astro.props`.\n\n```html title=data-meta is properly filled now!\n\u003Cpre\n\tclass=\"astro-code github-dark\"\n\tstyle=\"background-color:#24292e;color:#e1e4e8;overflow-x:auto\"\n\ttabindex=\"0\"\n\tdata-language=\"js\"\n\tdata-meta=\"foo\"\n>\n  \u003Ccode>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#F97583\">&lt;!\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">doctype html\u003C/span>\n      \u003Cspan style=\"color:#F97583\">&gt;\u003C/span>\n    \u003C/span>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#E1E4E8\">&lt;\u003C/span>\n      \u003Cspan style=\"color:#85E89D\">html\u003C/span>\n      \u003Cspan style=\"color:#B392F0\"> lang\u003C/span>\n      \u003Cspan style=\"color:#F97583\">=\u003C/span>\n      \u003Cspan style=\"color:#9ECBFF\">\"en\"\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">&gt;\u003C/span>\n    \u003C/span>\n    \u003Cspan class=\"line\">\n      \u003Cspan style=\"color:#E1E4E8\">  &lt;\u003C/span>\n      \u003Cspan style=\"color:#85E89D\">head\u003C/span>\n      \u003Cspan style=\"color:#E1E4E8\">&gt;\u003C/span>\n    \u003C/span>\n    \u003C!-- and the rest of the tags -->\n  \u003C/code>\n\u003C/pre>\n```\n\nSince we *might* be passing more metadata in the future, it's advisable to define a schema for writing metadata to avoid\nproblems during parsing in the future.\n\nFor the sake of simplicity, we are going to use `key1=value1,key2,[...key]` schema in this post that can be parsed with:\n\n```astro title=Parsing Shiki raw metadata through Astro.props\n---\nconst meta: Record\u003Cstring, string> = {};\nconst { 'data-meta': dataMeta, ...props } = Astro.props;\n\nif (dataMeta) {\n  dataMeta.split(',').forEach((prop: string) => {\n    const tokens = prop.split('=');\n    meta[tokens[0].trim()] = tokens[1];\n  });\n}\n\nconst title = meta.title;\n---\n```\n\nNow, we can *finally* move on to customizing the component.\n\n> For the sake of clarity, I'll be changing the default theme of Shiki to `min-light` which you can change via Astro config.\n>\n> ```js {6}\n> import { defineConfig } from 'astro/config';\n>\n> export default defineConfig({\n>    markdown: {\n>      shikiConfig: {\n>       theme: 'min-light',\n>\t  }\n>\t},\n> });\n> ```\n\n### Adding Captions\n\nTo add captions to the code block, we can pass the caption as `title` inside the metadata and embed it on `figcaption`:\n\n```astro title=CodeSnippet.astro, copyable\n---\nconst meta: Record\u003Cstring, string> = {};\nconst { 'data-meta': dataMeta, ...props } = Astro.props;\n\nif (dataMeta) {\n  dataMeta.split(',').forEach((prop: string) => {\n    const tokens = prop.split('=');\n    meta[tokens[0].trim()] = tokens[1];\n  });\n}\n\nconst title = meta.title;\n---\n\n\u003Cfigure class=\"overflow-hidden rounded-md\">\n  {\n    title && (\n      \u003Cfigcaption class=\"flex justify-between items-center text-xs p-2 px-4 border-b border-b-gray-500 leading-normal rounded-t-md bg-gray-700 text-white\">\n        \u003Cp class=\"mb-0\">{title}\u003C/p>\n      \u003C/figcaption>\n    )\n  }\n\n  \u003Cpre\n    class={`${className} relative rounded-none`}\n    {...props}>\u003Cslot />\u003C/pre>\n\u003C/figure>\n```\n\nAfter the changes has been applied, our component should look like this:\n\n![Look ma! I've added title to my component](https://res.cloudinary.com/namchee/image/upload/v1735005025/posts/supercharing-astro-code-snippet/adding-title)\n\n### Adding Line Numbers\n\nUnfortunately, neither Astro nor Shiki provides us with any APIs regarding line numbers. Therefore, we have to rely to good ol' CSS\nto implement this feature.\n\nSince all lines are actually `\u003Cspan>`s that have `line` as one of its class, we can combine the `::before` pseudo-element with [CSS Counters](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_counter_styles/Using_CSS_counters):\n\n```css title=Applying line numbers to code snippet using CSS counters, copyable\n.astro-code {\n  overflow-x: auto;\n}\n\n.astro-code code {\n  /* Define a counter for each \u003Ccode> inside .astro-code */\n  counter-reset: step;\n  /* Start from zero, increment the counter */\n  counter-increment: step 0;\n\n\tfont-size: 14px;\n\n  width: fit-content;\n  min-width: 100%;\n  display: block;\n}\n\n.astro-code code .line {\n  display: inline-block;\n  width: 100%;\n  padding-right: 2rem;\n}\n\n.astro-code code .line::before {\n  content: counter(step);\n  counter-increment: step;\n  width: 2rem;\n  margin-right: 1.25rem;\n  display: inline-block;\n  margin-left: auto;\n  text-align: right;\n\n  /* Fix element position during horizontal scroll */\n  position: sticky;\n  left: 0;\n  z-index: 1;\n\n  /* Give a bit of space to counter on horizontal scroll */\n  padding-right: 0.25rem;\n\n  /* Illustrative purpose, please extract the value from the theme instead */\n  background-color: white;\n  color: hsla(0, 0%, 0%, 0.5);\n}\n```\n\nAfter applying the CSS, our component should look like this:\n\n![Look ma, I've added line numbers to my component!](https://res.cloudinary.com/namchee/image/upload/v1735006683/posts/supercharing-astro-code-snippet/adding-line-numbers)\n\n### Adding Line Highlighting\n\nTo add highlights, we need to tell Shiki which line should be highlighted and Shiki needs to transform those lines to be distinguishable from non-highlighted lines. We can\nthen write a CSS style to mark those highlighted lines.\n\nFortunately, Shiki has already provided us with `transformerMetaHighlight` transformer that handles\nthis use case that we can install through `@shikijs/transformers` package and enable in our Astro config:\n\n```js title=astro.config.js,{14}\nimport { defineConfig } from 'astro/config';\n\nimport { transformerMetaHighlight } from '@shikijs/transformers';\n\nexport default defineConfig({\n  markdown: {\n    shikiConfig: {\n      transformers: [\n        {\n          pre(hast) {\n            hast.properties['data-meta'] = this.options.meta?.__raw;\n          }\n        },\n        transformerMetaHighlight(),\n      ]\n    }\n  },\n});\n```\n\nWe can then pass meta strings that defines lines that should be highlighted and style those highlighted lines with CSS:\n\n```css title=Styling highlighted line, copyable\n.astro-code code .line.highlighted {\n  /* light gray */\n  background-color: hsl(0, 0%, 90%);\n  /* Re-pad after border */\n  padding-left: 2px;\n}\n\n.astro-code code .line.highlighted span {\n  background-color: hsl(0, 0%, 90%);\n}\n\n.astro-code code .line.highlighted::before {\n  /* light gray */\n  background-color: hsl(0, 0%, 90%);\n  /* blue */\n\tborder-left: 2px solid hsl(217, 91%, 60%);\n  /* Restore position after border */\n  margin-left: -2px;\n  color: hsla(0, 0%, 0%, 0.75);\n}\n```\n\nAfter applying the highlighted CSS, our component should now look like this:\n\n![There, a beautiful highlight!](https://res.cloudinary.com/namchee/image/upload/v1735011183/posts/supercharing-astro-code-snippet/adding-highlight)\n\n### Showing Language\n\nSince Shiki has already passed the language in the `data-language` prop, we can easily grab it and display it on the top right of the `\u003Cpre>` as such:\n\n```astro title=CodeSnippet.astro, copyable\n---\nconst meta: Record\u003Cstring, string> = {};\nconst {\n  \"data-meta\": dataMeta,\n  \"data-language\": lang,\n  class: className,\n  ...props\n} = Astro.props;\n\nif (dataMeta) {\n  dataMeta.split(\",\").forEach((prop: string) => {\n    const tokens = prop.split(\"=\");\n    meta[tokens[0].trim()] = tokens[1];\n  });\n}\n\nconst title = meta.title;\n---\n\n\u003Cfigure class=\"overflow-hidden border border-gray-300 rounded-md\">\n  {\n    title && (\n      \u003Cfigcaption class=\"flex justify-between items-center text-xs p-2 px-4 border-b border-b-gray-300 leading-normal rounded-t-md bg-gray-100\">\n        \u003Cp class=\"mb-0\">{title}\u003C/p>\n      \u003C/figcaption>\n    )\n  }\n\n  \u003C!-- We can't directly set \u003Cpre> with relative, as we need to preserve original block size on horizontal scroll -->\n  \u003Cdiv class=\"relative\">\n    \u003Cp class=\"absolute top-3 right-4 text-xs text-gray-500 font-mono\">{lang}\u003C/p>\n    \u003Cpre class={`${className} rounded-none p-0`} {...props}>\u003Cslot />\u003C/pre>\n  \u003C/div>\n\u003C/figure>\n```\n\nThe language should be shown as a fixed element on the top right of the code block.\n\n![Which language was it again? Oh it was JavaScript](https://res.cloudinary.com/namchee/image/upload/v1735102259/posts/supercharing-astro-code-snippet/adding-language)\n\n### Adding Copy to Clipboard Button\n\nAfter a series of features that are uninteractive, we are finally moving to the final feature that requires a sprinkle of interactivity: copy to clipboard button.\n\nBefore we implement this feature, we need to ensure that the original content is accessible by our component. We can implement the same trick that we use\nto pass captions: pass them as an attribute called `data-code`\n\n```js title=astro.config.js, copy, {13}\nimport { defineConfig } from 'astro/config';\n\nimport { transformerNotationHighlight } from '@shikijs/transformers';\n\nexport default defineConfig({\n  markdown: {\n    shikiConfig: {\n      transformers: [\n        {\n          pre(hast) {\n            hast.properties['data-meta'] = this.options.meta?.__raw;\n            // the original source code is stored in `source` property\n            hast.properties['data-code'] = this.source;\n          }\n        },\n        transformerNotationHighlight(),\n      ]\n    }\n  },\n});\n```\n\nTo access user's clipboard, we need to use JavaScript to access the [Clipboard API](https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API)\nwhich is available on the `navigator` interface through the browser. The functionality\ncan then be triggered through a button click:\n\n```astro title=CodeSnippet.astro, copy, {45}\n---\nconst meta: Record\u003Cstring, string> = {};\nconst {\n  \"data-meta\": dataMeta,\n  \"data-code\": dataCode,\n  \"data-language\": lang,\n  class: className,\n  ...props\n} = Astro.props;\n\nif (dataMeta) {\n  dataMeta.split(\",\").forEach((prop: string) => {\n    const tokens = prop.split(\"=\");\n    meta[tokens[0].trim()] = tokens[1];\n  });\n}\n\nconst title = meta.title;\n---\n\n\u003Cfigure class=\"overflow-hidden border border-gray-300 rounded-md\">\n  {\n    title && (\n      \u003Cfigcaption class=\"flex justify-between items-center text-xs p-2 px-4 border-b border-b-gray-300 leading-normal rounded-t-md bg-gray-100\">\n        \u003Cp class=\"mb-0\">{title}\u003C/p>\n        \u003Cbutton id=\"copy__code\" class=\"text-sm text-gray-500\">\n          Copy Code\n        \u003C/button>\n      \u003C/figcaption>\n    )\n  }\n\n  \u003Cdiv class=\"relative\">\n    \u003Cp class=\"absolute top-3 right-4 text-xs text-gray-500 font-mono\">{lang}\u003C/p>\n    \u003Cpre class={`${className} rounded-none p-0`} {...props}>\u003Cslot />\u003C/pre>\n  \u003C/div>\n\u003C/figure>\n\n\u003Cscript define:vars={{ dataCode }}>\n  if (typeof navigator.clipboard !== undefined) {\n    const trigger = document.querySelector(\"#copy__code\");\n\n    trigger.addEventListener(\"click\", () => {\n      // Write the code to clipboard\n      navigator.clipboard.writeText(dataCode);\n    });\n  }\n\u003C/script>\n```\n\nNow, there should be a 'Copy Code' text on the top right of the code block. Try clicking the element\nand see if the code inside the code block is copied to your clipboard by pasting it somewhere.\n\n![Try clicking the Copy Code text!](https://res.cloudinary.com/namchee/image/upload/v1735139073/posts/supercharing-astro-code-snippet/adding-copy-to-clipboard)\n\n## Final Thoughts\n\nAnd there we have it. We have explored the capabilities of Astro API when handling MDX to transform our default code snippet component into a more feature-packed\ncode snippet without having to directly define them as markups.\n\nBy using the same method, we can customize other default components like [what I did to my mine](https://github.com/Namchee/site/tree/master/src/components/astro/modules/posts/html)\nor you can go one step further on the features like inline execution, download code as file, or even [giving animation of code transformation](https://github.com/shikijs/shiki-magic-move).\n\nLastly, you can try [Astro Expressive Code](https://expressive-code.com/) if you want a feature-packed code snippet without the hassle. However, I believe the\nthe method shown here still has its merits as outside syntax highlighting, we are in full control of the markup and behavior.","posts/upgrading-astro-code-snippets.mdx","e20d32e96737d3fa","utilpocalypse",{"id":91,"data":93,"body":98,"filePath":99,"digest":100,"deferredRender":22},{"title":94,"subtitle":95,"tags":96,"publishedAt":97,"isDraft":34},"Utilpocalypse","One god file to ruin them all",[44],["Date","2024-10-26T00:00:00.000Z"],"import DescriptionList from '@/components/astro/modules/posts/html/DescriptionList.astro';\nimport DescriptionTerm from '@/components/astro/modules/posts/html/DescriptionTerm.astro';\nimport DescriptionItem from '@/components/astro/modules/posts/html/DescriptionItem.astro';\n\nIt's weekend, you're burning up and currently building a killer side project that (hopefully) make billions\nin the future. You're starting of with writing a simple function for your authentication flow that transforms\na `pascalCase` string to a `snake_case` one.\n\n```ts title=auth.ts\n// ...the rest of authentication code\n\nfunction toSnakeCase(text: string): string {\n\treturn text.split(/\\.?(?=[A-Z])/)\n\t\t.join(\"_\")\n\t\t.toLowerCase();\n}\n```\n\nNice, that's one feature down! Suddenly, you realized that you *might* need to use this function somewhere\nelse and duplicating the function is a no-go since you just read the [Clean Code](https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882) book.\nA brilliant idea pops up on your head:\n\n> Hey, why don't I create a file that stores these small, reusable functions that can be imported from any files?\n\nYou finally extracted this function to a separate file that you call `util.ts`, thus mark the starting point of *utility* or\n*helper* file (or class / module). You are feeling that creating the utility file is the best decision you've made in this project.\n\n```ts title=util.ts\nexport function toSnakeCase(text: string): string {\n\treturn text.split(/\\.?(?=[A-Z])/)\n\t\t.join(\"_\")\n\t\t.toLowerCase();\n}\n```\n\n## From Utilities to Utilpocalypse\n\nTwo days later, a module needs to capitalize each words from a string to make them look prettier to the user.\nSince other modules _might_ also need this function, you decided to implement it by appending it to the utility file you've\ncreated previously.\n\n```ts title=The first addition to util.ts\nexport function toSnakeCase(text: string): string {\n\treturn text.split(/\\.?(?=[A-Z])/)\n\t\t.join(\"_\")\n\t\t.toLowerCase();\n}\n\nexport function capitalizeWords(text: string): string {\n\treturn text.split(\" \")\n\t\t.map(word => word.charAt(0).toUppercase() + word.slice(1).toLowercase())\n\t\t.join(\" \");\n}\n```\n\nThat's one small task down the drain and indeed, there _are_ modules that actually need this function too!\n\nBut the next day, you need a function to generate a random number between two values. Without thinking much, you implemented\nit in the utility file based on the previous positive experience.\n\n```ts title=The second addition to util.ts\nexport function toSnakeCase(text: string): string {\n\treturn text.split(/\\.?(?=[A-Z])/)\n\t\t.join(\"_\")\n\t\t.toLowerCase();\n}\n\nexport function capitalizeWords(text: string): string {\n\treturn text.split(\" \")\n\t\t.map(word => word.charAt(0).toUppercase() + word.slice(1).toLowercase())\n\t\t.join(\" \");\n}\n\n// inclusive random\nexport function randomInt(min: number, max: number): number {\n\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n}\n```\n\nAnd the implementation goes on and on with each passing days until 3 months later the utility file has bloated beyond\nbelief from trying to share small functions that _might_ be used by multiple modules.\n\n```ts title=The XXX addition to util.ts (why it's so big now?)\nexport function toSnakeCase(text: string): string {\n\treturn text.split(/\\.?(?=[A-Z])/)\n\t\t.join(\"_\")\n\t\t.toLowerCase();\n}\n\nexport function capitalizeWords(text: string): string {\n\treturn text.split(\" \")\n\t\t.map(word => word.charAt(0).toUppercase() + word.slice(1).toLowercase())\n\t\t.join(\" \");\n}\n\n// inclusive random\nexport function randomInt(min: number, max: number): number {\n\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\n// shuffle using Fisher-Yates\nexport function shuffleArray\u003CT = unknown>(array: T[]): T[] {\n\tlet currentIndex = array.length, randomIndex;\n\n\twhile (currentIndex !== 0) {\n\t\trandomIndex = Math.floor(Math.random() * currentIndex);\n\t    currentIndex--;\n\n\t    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];\n\t  }\n\n\t  return array;\n}\n\nexport function debounce\u003CT = (...args: unknown[]) => unknown>(func: T, wait: number): T {\n  let timeout;\n  return function(...args) {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func.apply(this, args), wait);\n  };\n}\n\n// and 50 more 'small' functions that constitues into a 2_000+ lines of code\n```\n\nWhile it _does_ solve the potential repetition problem, the utility file is now hardly readable\neven with the help of code comments and even harder to maintain due it sheer size. At this point,\nthe code has reached a point that I call **utilpocalypse**.\n\n## The Problem With Utilpocalypse\n\nUsing a utility file isn't 100% a bad thing. Compared to using something robust like [design patterns](https://refactoring.guru/), they are\nmuch simpler and have lower overhead. However, bloating your utility file to the point of utilpocalypse poses several problems:\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    Unclear Intentions\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    [Intention-revealing names](https://wiki.c2.com/?IntentionRevealingNames) is one of recommended practices in software development,\n    which can also be applied to files. What a file does should be clear just from reading its name.\n\n    But what can we actually discern from a file called `util`, `lib`, `common`, or `helper`? Yes, it's a utility, but what _kind_ of utility is it?\n    At a hindsight, it doesn't look too bad... until you see this kind of folder structure from my old project.\n\n    ![Utilities of utility of libraries. Very clear indeed](https://res.cloudinary.com/namchee/image/upload/v1729928350/posts/utilpocalypse/nested-utils.jpg)\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Maintenance Nightmare\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    One day, you need a utility and want to check if the function has been implemented or not.\n    Since you have a utility file, you decide to search for relevant implementations on the file.\n    Unfortunately, it's hard to traverse the file with naked eye due to its bloated size.\n\n    Although the IDE search functionality helps, the implementation still escapes your search as it exist\n    with a different name ([naming things are hard](https://martinfowler.com/bliki/TwoHardThings.html) you know?) and you're not sure how to query it correctly.\n    Since you can't find it, you implemented it from scratch and appended it.\n\n    Congratulations, you have unintentionally created a [functional duplication](https://blog.cleancoder.com/uncle-bob/2021/10/28/functional-duplication.html) which is a problem that utility file tries to solve!\n\n    Other problems with utilpocalypse is they are harder to test due to the sheer number of code it contains and harder to refactor due to the possibility\n    of utilities that depends on other utilities.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Promoting Bad Practices\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    When you need a functionality, you will instinctively try to append it to the utility file instead of trying to do intricate design of the implementation to avoid code smells, thus adding more bloat to the utility file.\n\n    It works _before_ (when the utility file hasn't reached utilpocalypse), why not now?\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\nIn simple terms, utilpocalypse is a concrete case of [god objects](https://en.wikipedia.org/wiki/God_object).\nIt's too big and contains too much capabilities.\n\n## Untangling Utilpocalypse\n\nAs I've said in the previous section, I don't disregard utility module as something taboo. The main problem of utilpocalypse is *how the utilities are being structured*.\nIn short, you shouldn't combine your utilities into a single file or module.\n\nThere are two ways to organize your utilities without grouping them into a single module and turning them into a utilpocalypse:\n\n\u003CDescriptionList>\n  \u003CDescriptionTerm>\n    Group by Proximity\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    The first and the most effective way to untangle the utilpocalypse is by organizing the utilities by their proximity.\n\n    Suppose that you want to extract a group of utilities that's only used by a specific module, instead of extracting them into the global utility,\n    you can create a local utility module that is not exposed outside the module instead of appending it to the global utility module.\n  \u003C/DescriptionItem>\n\n  \u003CDescriptionTerm>\n    Group By Functionality\n  \u003C/DescriptionTerm>\n  \u003CDescriptionItem>\n    In most cases, utilities can be grouped by their similar functionalities. The usual way to organize utilities is by creating\n    a utility folder and group utilities together into modules or service classes.\n\n    From the example above, we can group `toSnakeCase` and `capitalizeWords` into a utility module called `string.ts`\n    as they both deals with strings, `shuffleArray` into a module called `array.ts`, etc.\n\n    > You might be wondering on how to determine the newly separated module name.\n    > The thing is, you can name them whatever you want as long as its not something generic like `util(s)`, `helper`, `lib`, `common`, `handler`, and other similar words.\n\n    Do keep in mind that having too much module in the same level may cause maintenance problems. Try to find your own\n    sweet spot by limiting the number of utility modules or logically group them into subdirectories.\n  \u003C/DescriptionItem>\n\u003C/DescriptionList>\n\n## Final Thoughts\n\nUtility module is widely known as a good tool to share small-but-reusable libraries to multiple unrelated module.\nAlas like every other good tool, using it irresponsibly turns them into a utilpocalypse which can slow your development workflow.\n\nWhen a utilpocalypse happens, don't be afraid to split and organize your utilities by their proximity or functionalities into smaller\nand more focused utility modules. Find your own sweet spot and [move those utilities until it feels right](https://react-file-structure.surge.sh/).\n\nAlthough it feels wasteful on small scale projects, keeping your utilities clean will save your time from unnecessary searching and accidental duplication.","posts/utilpocalypse.mdx","80f2c797f83b9aca"]